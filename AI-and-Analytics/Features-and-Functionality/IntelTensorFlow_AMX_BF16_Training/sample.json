{
  "guid": "030C6A71-39DA-436E-9644-4FC25C7C5907",
  "name": "TensorFlow Training Optimizations with Advanced Matrix Extensions Bfloat16",
  "categories": ["Toolkit/oneAPI AI And Analytics/Features and Functionality"],
  "description": "This sample illustrates how to train a TensorFlow model using Advanced Matrix Extensions Bfloat16",
  "builder": ["cli"],
  "languages": [{ "python": {} }],
  "os": ["linux"],
  "targetDevice": ["CPU"],
  "cpuInstructionSets": ["AVX512", "AMX"],
  "ciTests": {
    "linux": [{
      "id": "intel amx bf16 training",
      "steps": [
        "source /intel/oneapi/intelpython/bin/activate",
        "conda activate tensorflow",
        "pip install uv",
        "uv init",
        "uv python pin $(which python)",
        "uv venv --system-site-packages",
        "uv add -r requirements.txt",
        "uv add --dev ipykernel notebook",
        "uv add numpy==1.26.4",
        "uv add keras==2.15.0",
        "export execution_mode=eager",
        "uv run python Intel_TensorFlow_AMX_BF16_Training.py -m eager",
        "uv run ipython kernel install --user --name tensorflow",
        "uv run jupyter nbconvert --ExecutePreprocessor.enabled=True --ExecutePreprocessor.kernel_name=tensorflow --to notebook IntelTensorFlow_AMX_BF16_Training.ipynb"
      ]
    }]
  },
  "expertise": "Code Optimization"
}
